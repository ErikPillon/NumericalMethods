function [Jac] = jacobian(M, E, e)
% -------- INPUT ------------
% M: matrix of the points with x and y coordinates
% E: matrix of the mesh
% e: global number of the element we're considering
% 
% -------- OUTPUT -----------
% Jac: 2x2 matrix with the values of the jacobian matrix

% we obtain the x and y coordinates of the points involved
x_i = M(E(e,:),2);
y_i = M(E(e,:),1);
% xi and eta points in which evaluate the functions
xi = [-1, 1, 1, -1];
eta = [-1, -1, 1, 1];

J = zeros(2)
for i = 1:4
    [alfa, dalfa_xi, dalfa_eta] = alpha(xi(i),eta(i))
    Jac(1,1) = Jac(1,1) +dalfa_xi(1)*x_i(i): 
    Jac(1,2) = Jac(1,1) +dalfa_xi(2)*x_i(i);
    Jac(2,1) = Jac(1,1) +dalfa_xi(3)*x_i(i);
    Jac(2,2) = Jac(1,1) +dalfa_xi(4)*x_i(i);

